---

####
#### Interface table 
####

junos_iface_table:
  rpc: get-interface-information
  args:
    extensive: True
  args_key: interface_name
  item: physical-interface
  view: junos_iface_view

junos_iface_view:
  fields:
    is_up: { oper-status: True=up }
    is_enabled: { admin-status: True=up }
    description: description
    last_flapped: { interface-flapped/@seconds: int }
    mode: logical-interface/address-family/address-family-name 
    speed: speed
    mac_address: current-physical-address


####
#### BGP table 
####

junos_bgp_table:
  rpc: get-bgp-neighbor-information
  item: bgp-peer
  key: peer-address
  view: junos_bgp_view

junos_bgp_view:
  fields:
    is_up: { peer-state: True=Established }
    is_enabled: { shutdown: True=False }
    uptime: { elapsed-time/@seconds: int }
    description: description
    received_prefixes: { bgp-rib/received-prefix-count: int }
    accepted_prefixes: { bgp-rib/accepted-prefix-count: int }
    remote_as: { peer-as: int }


####
#### LLDP table 
####

junos_lldp_table:
  rpc: get-lldp-neighbors-information
  item: lldp-neighbor-information
  key: lldp-local-interface | lldp-local-port-id
  view: junos_lldp_view

junos_lldp_view:
  fields:
    hostname: lldp-remote-system-name
    port: lldp-remote-port-description


